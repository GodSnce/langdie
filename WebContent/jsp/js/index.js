LM.Index={};LM.Index.o={nav:document.getElementById("nav").getElementsByTagName("a"),module:[document.getElementById("focus"),document.getElementById("focus_main")],focus:{wrap:document.getElementById("focus"),main:document.getElementById("focus_main")},back:document.getElementById("back")};LM.Index.d={scroll_top:0,doc_height:0,doc_width:0,scroll_animate:0};LM.Index.cal=function(){LM.Index.d.doc_width=document.body.clientWidth;LM.Index.d.doc_height=LM.Index.d.doc_width*1270/2560;try{var e=document.createElement("style");e.type="text/css";e.innerHTML="";e.innerHTML+=".doc_height {height:"+LM.Index.d.doc_height+"px;}";e.innerHTML+=".doc_width {width:"+LM.Index.d.doc_width+"px;}";document.getElementsByTagName("HEAD").item(0).appendChild(e)}catch(t){var i=document.createStyleSheet();i.addRule(".doc_height","height:"+LM.Index.d.doc_height+"px");i.addRule(".doc_width","width:"+LM.Index.d.doc_width+"px")}};LM.Index.scroll=function(){for(var e=0;e<LM.Index.o.nav.length;e++){LM.Index.o.nav[e].index=e;LM.Index.o.nav[e].onmouseover=function(){if(this.index==4){return}clearInterval(LM.Index.d.scroll_animate);LM.Index.flip(this)}}};LM.Index.flip=function(e){var t=document.getElementById(e.getAttribute("data-id"));var i=Z.getElemPos(t).y;var n=document.body.scrollTop||document.documentElement.scrollTop||0;LM.Index.d.scroll_animate=setInterval(function(){i>n?n=n+Math.ceil((i-n)/5):n=n+Math.floor((i-n)/5);if(n!=i){window.scrollTo(0,n)}else{window.scrollTo(0,i);clearInterval(LM.Index.d.scroll_animate)}},20)};LM.Index.slide=function(){this.init()};LM.Index.slide.prototype={init:function(){this.width=LM.Index.d.doc_width;this.obj=LM.Index.o.focus.wrap;this.o={};this.o.ul=LM.Index.o.focus.main;this.o.li=LM.Index.o.focus.sub;this.li_length=this.o.li.length;this.atime=0;this.stime=0;this.page=0;this.stop=0;this.arrow();this.dot()},arrow:function(){if(this.li_length<2){return false}var e=this;var t=document.createElement("div");t.className="focus_arrow";t.innerHTML='<a href="javascript:;" class="a_0"></a><a href="javascript:;" class="a_1"></a>';this.obj.appendChild(t);var i=t.getElementsByTagName("a");i[0].onclick=function(){clearInterval(e.atime);clearInterval(e.stime);e.flipPrev();e.stop=1;e.autoFlip()};i[1].onclick=function(){clearInterval(e.atime);clearInterval(e.stime);e.flipNext();e.stop=1;e.autoFlip()}},dot:function(){if(this.li_length<2){return false}var e=this;var t=document.createElement("div");t.className="focus_dot";var i=document.createElement("ul");for(var n=0;n<this.li_length;n++){var l=document.createElement("li");if(n==0){l.className="active"}i.appendChild(l)}var a=document.createElement("div");a.appendChild(i);t.appendChild(a);this.obj.appendChild(t);this.o.sub=t.getElementsByTagName("li");for(var n=0;n<this.o.sub.length;n++){this.o.sub[n].index=n;this.o.sub[n].onclick=function(){clearInterval(e.atime);clearInterval(e.stime);e.flip(this.index);e.stop=1;e.autoFlip()}}this.autoFlip()},flip:function(e){var t=this;if(this.o.sub){for(var i=0;i<this.o.sub.length;i++){if(i==e){this.o.sub[i].className="active"}else{this.o.sub[i].className=""}}}var n=e;var l=this.page-e;if(Math.abs(l)==this.li_length-1){if(l<0){var a=document.createElement("div");a.className=this.o.li[this.li_length-1].className;a.innerHTML=this.o.li[this.li_length-1].innerHTML;this.o.ul.insertBefore(a,this.o.li[0]);this.o.ul.style.marginLeft="-"+this.width+"px";n=0}else{var a=document.createElement("div");a.className=this.o.li[0].className;a.innerHTML=this.o.li[0].innerHTML;this.o.ul.appendChild(a);n=this.li_length}}var s=0-n*this.width;this.stime=setInterval(function(){var i=parseInt(t.o.ul.style.marginLeft)||0;s>i?i=i+Math.ceil((s-i)/5):i=i+Math.floor((s-i)/5);if(i==s){t.o.ul.style.marginLeft=i+"px";clearInterval(t.stime);t.page=e;if(a){t.o.ul.removeChild(a);t.o.ul.style.marginLeft=0-e*t.width+"px"}}else{t.o.ul.style.marginLeft=i+"px"}},20)},flipNext:function(){clearInterval(this.stime);var e;this.page==this.li_length-1?e=0:e=this.page+1;this.flip(e)},flipPrev:function(){clearInterval(this.stime);var e;this.page==0?e=this.li_length-1:e=this.page-1;this.flip(e)},autoFlip:function(){var e=this;this.atime=setInterval(function(){e.flipNext()},5000)}};LM.Index.init=function(){var e;Z.addEvent(window,"resize",function(){clearTimeout(e);e=setTimeout(LM.Index.cal,100)});LM.Index.cal();LM.Index.scroll();LM.Index.o.focus.sub=Z.getElemByClass(LM.Index.o.focus.main,"focus_sub","DIV");if(LM.Index.o.focus.sub.length>1){new LM.Index.slide}};LM.Index.init();